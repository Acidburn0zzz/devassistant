c:
  fullname: C Language Tool

  dependencies:
  - rpm: ['gcc', 'gcc-c++','glibc-devel', 'automake', 'autoconf','valgrind','gdb','ddd','strace', 'vim-enhanced', 'vim-X11']

  dependencies_build:
  - rpm: ['rpm-build','mock','eclipse-rpm-editor']

  dependencies_eclipse:
  - rpm: ['eclipse-mylyn-context-cdt','eclipse-egit','eclipse-cdt','eclipse-cdt-parsers','eclipse-cdt-sdk']

  dependencies_vim:
  - rpm: ['vim-nerdtree']

  args:
    name:
      snippet: common_args

    build:
      flags:
      - -b
      - --build
      help:
        'This will create SRPM and RPM packages.'
      nargs:
        '?'
    vim:
      snippet: common_args

    eclipse:
      snippet: common_args

    github:
      snippet: common_args

  files:
    csources: &csources
      source: c/
    vim_update: &vim_update
      source: vim_update.sh
    vimrc: &vimrc
      source: vimrc
    vimdoc: &vimdoc
      source: vim/doc/
    vimplugin: &vimplugin
      source: vim/plugin/
    vimpixmaps: &vimpixmaps
      source: vim/pixmaps/
    vimultisnips: &vimultisnips
      source: UltiSnips-2.2.tar.gz

  run:
  - log_i: 'Copying c source tree to project destination'
  - if not ls $name:
    - cl_f: cp -r *csources $name
    - dda_c: $name
    - cl: cd $name
    - snippet: git_init_add_commit
  - else:
    - cl: cd $name
  - if not defined $build:
    - log_i: 'Run autoreconf'
    - cl_f: autoreconf --install
    - log_i: 'Run configure script'
    - cl_f: ./configure
    - log_i: 'Compilation sources'
    - cl_f: make
    - log_i: 'Calling make distcheck for creating tar ball'
    - cl_f: make distcheck # will create distribution tar ball for later on usage
    - log_i: 'Inside $name project is the README file where are described steps'
    - log_i: 'how to integrate a new sources into your project.'
    - log_i: 'In case of any troubles please read manual for automake / autoconf.'
    - log_i: 'More information about autotools can be found here:'
    - log_i: 'automake: www.gnu.org/software/automake/manual/automake.html'
    - log_i: 'autoconf: www.gnu.org/software/autoconf/manual/autoconf.html' 
  - if defined $build:
    - log_i: 'Creating spec file'
    - cl: rpmdev-setuptree
    - cl: rm -f ~/rpmbuild/SPECS/cdevelopmenttool.spec
    - cl: cp cdevelopmenttool-1.0.tar.gz ~/rpmbuild/SOURCES
    - cl: cp cdevelopmenttool.spec ~/rpmbuild/SPECS
    - cl: cd ~/rpmbuild/SPECS
    - cl_f: sudo yum-builddep ~/rpmbuild/SPECS/cdevelopmenttool.spec
    - log_i: 'Creating RPM from tarball'
    - cl_f: rpmbuild -ba cdevelopmenttool.spec
    #- log_i: 'Creating RPM from SRPM over mock'
    #- cl_f: rpmbuild -bs cdevelopmenttool.spec
    #- cl_f: mock -r $build ~/rpmbuild/SRPMS/cdevelopmenttool-1.0-0.src.rpm
  run_vim:
    - log_i: "Settings VIM environment"
    - cl_f: cp -rv *vimplugin ~/.vim/
    - cl_f: cp -rv *vimdoc ~/.vim/
    - cl_f: cp -rv *vimpixmaps ~/.vim/
    - cl_f: tar -xzvf *vimultisnips -C ~/.vim/
    - cl: mv ~/.vim/UltiSnips-2.2 ~/.vim/UltiSnips
    - log_i: "Calling *vim_update *vimrc"
    - cl_f: bash *vim_update *vimrc

  run_eclipse:
    - if not ls $name:
        - log_i: "Project was not created yet. It's creating now"
        - run: run
    - cl: cd $name
    - log_i: 'Creating eclipse project from command line'
    - cl_f: make clean
    - cl: cd ..
    - cl: mkdir -p $eclipse/$name
    - if ls $name/.eclipseproject:
      - log_i: 'Project was not imported to eclipse environment yet'
      - cl: sed -i s|<name>cdevelassistant<|<name>$name<| $name/.eclipseproject
      - cl: mv $name/.eclipseproject $name/.project
      - cl: cp $name/.project $eclipse/$name/.project
      - cl: cp $name/.cproject $eclipse/$name/.cproject
      - cl: cp $name/.autotools $eclipse/$name/.autotools
      - log_i: 'Copying neccessary files was done'
    - else:
      - log_i: 'Project was already imported into eclipse environment'
    - cl: eclipse -nosplash -application org.eclipse.cdt.managedbuilder.core.headlessbuild -import ./$name -data $eclipse
    - log_i: 'Import to Eclipse is done.'
    - log_i: 'Start eclipse for developping.'

  run_github:
    - log_i: "Push on GitHub repository"
    - if not ls $name:
        - log_i: "Project wasn't created yet. It's creating now"
        - run: run
        - cl: cd ../
    - github: create_and_push
