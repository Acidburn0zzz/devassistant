django:
  fullname: Django
  description: 'Django assistant will help you create a basic Django project and install dependencies.'

  dependencies:
  - default:
    - rpm: ['python-django']
  - _eclipse:
    - rpm: ['eclipse-pydev']

  args:
    name:
      flags:
      - -n
      - --name
      help:
        'Name of project to create'
      required:
        True

    eclipse:
      flags:
      - -e
      - --eclipse
      help:
        'Configure as Eclipse workspace (uses ~/workspace or specified directory).'
      action:
        [default_iff_used, ~/workspace]
      nargs:
        '?'

    github:
      flags:
      - -g
      - --github
      help:
        'This will create a Git Hub repository according to the project name and push your source there.'
      nargs:
        '?'

  files:
    gitignore: &gitignore
      source: python/.gitignore
    dot_project: &dot_project
      source: python/django/.project
    dot_pydevproject: &dot_pydevproject
      source: python/django/.pydevproject

  run:
  - $dirname: dirname $name
  - $basename: basename $name
  - log_i: 'Creating Django project $basename in $dirname.'
  - if ls $name:
    - log_e: '$name already exists, cannot proceed.'
  - cl: cd $dirname
  - cl: django_admin startproject $basename
  - cl: cd $basename
  - if $eclipse:
    - log_i: 'Registering as Eclipse project...'
    - cl: cp *dot_project .
    - cl: cp *dot_pydevproject .
    - cl: sed -i 's|NAME|$basename|' .project
    - cl: sed -i 's|NAME|$basename|' .pydevproject
    - cl: eclipse -nosplash -application org.eclipse.cdt.managedbuilder.core.headlessbuild -import $name -data $eclipse
    - log_i: 'Registered as Eclipse project.'
  - cl: cp *gitignore .
  - cl: git init
  - cl: git add --all
  - cl: git commit -m "Initial commit"
  - if defined $github:
    - github: create_and_push
  - log_i: 'Django project $basename in $dirname has been created.'
